<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dartball Scorekeeper - Live</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f0f0f0; padding: 20px; }
        .scoreboard { background: white; padding: 20px; border-radius: 10px; text-align: center; }
        button { padding: 10px 20px; margin: 5px; font-size: 18px; }
        .bases { font-size: 24px; margin: 10px; }
        input { font-size: 18px; padding: 5px; }
    </style>
    <!-- Firebase SDK -->
 <script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js';
  import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js';

  const firebaseConfig = {
    apiKey: "AIzaSyAp3teE0EOa7iF69EIVNll7FSaFMRKJzEE",
    authDomain: "dartball-4f29e.firebaseapp.com",
    databaseURL: "https://dartball-4f29e-default-rtdb.firebaseio.com",
    projectId: "dartball-4f29e",
    storageBucket: "dartball-4f29e.firebasestorage.app",
    messagingSenderId: "363609573700",
    appId: "1:363609573700:web:2dd01042ada7a080feef11"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const liveRef = ref(db, 'dartball/live');

  // Listen for live updates
  onValue(liveRef, (snapshot) => {
    const data = snapshot.val();
    if (!data) return;

    document.getElementById('inning').textContent = `${data.half || 'Top'} ${data.inning}`;
    document.getElementById('teamA-score').textContent = data.teamA || 0;
    document.getElementById('teamB-score').textContent = data.teamB || 0;
    document.getElementById('outs').textContent = data.outs || 0;

    document.getElementById('batter-name').textContent = data.batter || '—';
    document.getElementById('defender-name').textContent = data.defender || '—';

    // Bases
    ['first', 'second', 'third'].forEach(base => {
      const el = document.getElementById(base + '-player');
      const occupied = !!data.bases[base];
      el.textContent = occupied ? data.bases[base] : '';
      document.getElementById(base).classList.toggle('occupied', occupied);
    });

    // Runs this inning + scoring lines
    document.getElementById('home-runs').textContent = data.runsThisInning || 0;
    if (data.runsThisInning > 0) document.getElementById('home-plate').classList.add('has-runs');

    const rs = document.getElementById('runners-scored');
    const rc = document.getElementById('rbi-credit');
    if (rs) rs.innerHTML = data.runnersScored || '—';
    if (rc) rc.innerHTML = data.rbiCredit || '—';

    console.log('Live update received');
  });
</script>
</head>
<body>
    <h1>Dartball Scorekeeper</h1>
    <div class="scoreboard">
        <h2 id="inning">Top 1st</h2>
        <p>Home: <span id="scoreHome">0</span> | Visitor: <span id="scoreVisitor">0</span></p>
        <div class="bases">Bases: 1st ◇ 2nd ◇ 3rd ◇</div>
        <p>Outs: <span id="outs">0</span> | Batter: <span id="batter">A1</span></p>
        <button onclick="updateScore('run', 1)">Run Scored</button>
        <button onclick="updateScore('out', 1)">Out</button>
        <!-- Add more: Single, Double, etc. – tie to your plays -->
        <button onclick="location.href='../dartball/'">Back to Manager</button>
    </div>
    <script>
        // Non-module updates (display refresh)
        function updateDisplay() {
            document.getElementById('inning').textContent = (gameState.topBottom === 'top' ? 'Top ' : 'Bottom ') + gameState.inning + 'th';
            document.getElementById('scoreHome').textContent = gameState.scoreHome;
            // ... update other elements
        }
        // Call updateDisplay() after saves
    </script>
</body>
</html>
